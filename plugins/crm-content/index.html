<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.0.preview.7">
<meta name="description" content="Official documentation for the GR8 CRM Content Management Plugin">
<meta name="keywords" content="groovy, grails, crm, gr8crm, documentation">
<meta name="author" content="Göran Ehrsson">
<title>GR8 CRM - Content Management Plugin</title>
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
article, aside, details, figcaption, figure, footer, header, hgroup, main, nav, section, summary { display: block; }
audio, canvas, video { display: inline-block; }
audio:not([controls]) { display: none; height: 0; }
[hidden], template { display: none; }
script { display: none !important; }
html { font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; }
body { margin: 0; }
a { background: transparent; }
a:focus { outline: thin dotted; }
a:active, a:hover { outline: 0; }
h1 { font-size: 2em; margin: 0.67em 0; }
abbr[title] { border-bottom: 1px dotted; }
b, strong { font-weight: bold; }
dfn { font-style: italic; }
hr { -moz-box-sizing: content-box; box-sizing: content-box; height: 0; }
mark { background: #ff0; color: #000; }
code, kbd, pre, samp { font-family: monospace, serif; font-size: 1em; }
pre { white-space: pre-wrap; }
q { quotes: "\201C" "\201D" "\2018" "\2019"; }
small { font-size: 80%; }
sub, sup { font-size: 75%; line-height: 0; position: relative; vertical-align: baseline; }
sup { top: -0.5em; }
sub { bottom: -0.25em; }
img { border: 0; }
svg:not(:root) { overflow: hidden; }
figure { margin: 0; }
fieldset { border: 1px solid #c0c0c0; margin: 0 2px; padding: 0.35em 0.625em 0.75em; }
legend { border: 0; padding: 0; }
button, input, select, textarea { font-family: inherit; font-size: 100%; margin: 0; }
button, input { line-height: normal; }
button, select { text-transform: none; }
button, html input[type="button"], input[type="reset"], input[type="submit"] { -webkit-appearance: button; cursor: pointer; }
button[disabled], html input[disabled] { cursor: default; }
input[type="checkbox"], input[type="radio"] { box-sizing: border-box; padding: 0; }
input[type="search"] { -webkit-appearance: textfield; -moz-box-sizing: content-box; -webkit-box-sizing: content-box; box-sizing: content-box; }
input[type="search"]::-webkit-search-cancel-button, input[type="search"]::-webkit-search-decoration { -webkit-appearance: none; }
button::-moz-focus-inner, input::-moz-focus-inner { border: 0; padding: 0; }
textarea { overflow: auto; vertical-align: top; }
table { border-collapse: collapse; border-spacing: 0; }
meta.foundation-mq-small { font-family: "only screen and (min-width: 768px)"; width: 768px; }
meta.foundation-mq-medium { font-family: "only screen and (min-width:1280px)"; width: 1280px; }
meta.foundation-mq-large { font-family: "only screen and (min-width:1440px)"; width: 1440px; }
*, *:before, *:after { -moz-box-sizing: border-box; -webkit-box-sizing: border-box; box-sizing: border-box; }
html, body { font-size: 100%; }
body { background: white; color: #222222; padding: 0; margin: 0; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; line-height: 1; position: relative; cursor: auto; }
a:hover { cursor: pointer; }
img, object, embed { max-width: 100%; height: auto; }
object, embed { height: 100%; }
img { -ms-interpolation-mode: bicubic; }
#map_canvas img, #map_canvas embed, #map_canvas object, .map_canvas img, .map_canvas embed, .map_canvas object { max-width: none !important; }
.left { float: left !important; }
.right { float: right !important; }
.text-left { text-align: left !important; }
.text-right { text-align: right !important; }
.text-center { text-align: center !important; }
.text-justify { text-align: justify !important; }
.hide { display: none; }
.antialiased, body { -webkit-font-smoothing: antialiased; }
img { display: inline-block; vertical-align: middle; }
textarea { height: auto; min-height: 50px; }
select { width: 100%; }
p.lead, .paragraph.lead > p, #preamble > .sectionbody > .paragraph:first-of-type p { font-size: 1.21875em; line-height: 1.6; }
.subheader, #content #toctitle, .admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title, .tableblock > caption { line-height: 1.4; color: #7a2518; font-weight: 300; margin-top: 0.2em; margin-bottom: 0.5em; }
div, dl, dt, dd, ul, ol, li, h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6, pre, form, p, blockquote, th, td { margin: 0; padding: 0; direction: ltr; }
a { color: #005498; text-decoration: underline; line-height: inherit; }
a:hover, a:focus { color: #00467f; }
a img { border: none; }
p { font-family: inherit; font-weight: normal; font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; text-rendering: optimizeLegibility; }
p aside { font-size: 0.875em; line-height: 1.35; font-style: italic; }
h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { font-family: Georgia, "URW Bookman L", Helvetica, Arial, sans-serif; font-weight: normal; font-style: normal; color: #ba3925; text-rendering: optimizeLegibility; margin-top: 1em; margin-bottom: 0.5em; line-height: 1.2125em; }
h1 small, h2 small, h3 small, #toctitle small, .sidebarblock > .content > .title small, h4 small, h5 small, h6 small { font-size: 60%; color: #e99b8f; line-height: 0; }
h1 { font-size: 2.125em; }
h2 { font-size: 1.6875em; }
h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.375em; }
h4 { font-size: 1.125em; }
h5 { font-size: 1.125em; }
h6 { font-size: 1em; }
hr { border: solid #dddddd; border-width: 1px 0 0; clear: both; margin: 1.25em 0 1.1875em; height: 0; }
em, i { font-style: italic; line-height: inherit; }
strong, b { font-weight: bold; line-height: inherit; }
small { font-size: 60%; line-height: inherit; }
code { font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; color: #6d180b; }
ul, ol, dl { font-size: 1em; line-height: 1.6; margin-bottom: 1.25em; list-style-position: outside; font-family: inherit; }
ul, ol { margin-left: 1.5em; }
ul.no-bullet, ol.no-bullet { margin-left: 1.5em; }
ul li ul, ul li ol { margin-left: 1.25em; margin-bottom: 0; font-size: 1em; }
ul.square li ul, ul.circle li ul, ul.disc li ul { list-style: inherit; }
ul.square { list-style-type: square; }
ul.circle { list-style-type: circle; }
ul.disc { list-style-type: disc; }
ul.no-bullet { list-style: none; }
ol li ul, ol li ol { margin-left: 1.25em; margin-bottom: 0; }
dl dt { margin-bottom: 0.3125em; font-weight: bold; }
dl dd { margin-bottom: 1.25em; }
abbr, acronym { text-transform: uppercase; font-size: 90%; color: #222222; border-bottom: 1px dotted #dddddd; cursor: help; }
abbr { text-transform: none; }
blockquote { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
blockquote cite { display: block; font-size: inherit; color: #555555; }
blockquote cite:before { content: "\2014 \0020"; }
blockquote cite a, blockquote cite a:visited { color: #555555; }
blockquote, blockquote p { line-height: 1.6; color: #6f6f6f; }
.vcard { display: inline-block; margin: 0 0 1.25em 0; border: 1px solid #dddddd; padding: 0.625em 0.75em; }
.vcard li { margin: 0; display: block; }
.vcard .fn { font-weight: bold; font-size: 0.9375em; }
.vevent .summary { font-weight: bold; }
.vevent abbr { cursor: auto; text-decoration: none; font-weight: bold; border: none; padding: 0 0.0625em; }
@media only screen and (min-width: 768px) { h1, h2, h3, #toctitle, .sidebarblock > .content > .title, h4, h5, h6 { line-height: 1.4; }
  h1 { font-size: 2.75em; }
  h2 { font-size: 2.3125em; }
  h3, #toctitle, .sidebarblock > .content > .title { font-size: 1.6875em; }
  h4 { font-size: 1.4375em; } }
.print-only { display: none !important; }
@media print { * { background: transparent !important; color: #000 !important; box-shadow: none !important; text-shadow: none !important; }
  a, a:visited { text-decoration: underline; }
  a[href]:after { content: " (" attr(href) ")"; }
  abbr[title]:after { content: " (" attr(title) ")"; }
  .ir a:after, a[href^="javascript:"]:after, a[href^="#"]:after { content: ""; }
  pre, blockquote { border: 1px solid #999; page-break-inside: avoid; }
  thead { display: table-header-group; }
  tr, img { page-break-inside: avoid; }
  img { max-width: 100% !important; }
  @page { margin: 0.5cm; }
  p, h2, h3, #toctitle, .sidebarblock > .content > .title { orphans: 3; widows: 3; }
  h2, h3, #toctitle, .sidebarblock > .content > .title { page-break-after: avoid; }
  .hide-on-print { display: none !important; }
  .print-only { display: block !important; }
  .hide-for-print { display: none !important; }
  .show-for-print { display: inherit !important; } }
table { background: white; margin-bottom: 1.25em; border: solid 1px #dddddd; }
table thead, table tfoot { background: whitesmoke; font-weight: bold; }
table thead tr th, table thead tr td, table tfoot tr th, table tfoot tr td { padding: 0.5em 0.625em 0.625em; font-size: inherit; color: #222222; text-align: left; }
table tr th, table tr td { padding: 0.5625em 0.625em; font-size: inherit; color: #222222; }
table tr.even, table tr.alt, table tr:nth-of-type(even) { background: #f9f9f9; }
table thead tr th, table tfoot tr th, table tbody tr td, table tr td, table tfoot tr td { display: table-cell; line-height: 1.6; }
.clearfix:before, .clearfix:after, .float-group:before, .float-group:after { content: " "; display: table; }
.clearfix:after, .float-group:after { clear: both; }
*:not(pre) > code { font-size: 0.9375em; padding: 1px 3px 0; white-space: nowrap; background-color: #f2f2f2; border: 1px solid #cccccc; -webkit-border-radius: 4px; border-radius: 4px; text-shadow: none; }
pre, pre > code { line-height: 1.4; color: inherit; font-family: Consolas, "Liberation Mono", Courier, monospace; font-weight: normal; }
.keyseq { color: #555555; }
kbd:not(.keyseq) { display: inline-block; color: #222222; font-size: 0.75em; line-height: 1.4; background-color: #F7F7F7; border: 1px solid #ccc; -webkit-border-radius: 3px; border-radius: 3px; -webkit-box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; box-shadow: 0 1px 0 rgba(0, 0, 0, 0.2), 0 0 0 2px white inset; margin: -0.15em 0.15em 0 0.15em; padding: 0.2em 0.6em 0.2em 0.5em; vertical-align: middle; white-space: nowrap; }
.keyseq kbd:first-child { margin-left: 0; }
.keyseq kbd:last-child { margin-right: 0; }
.menuseq, .menu { color: #090909; }
b.button:before, b.button:after { position: relative; top: -1px; font-weight: normal; }
b.button:before { content: "["; padding: 0 3px 0 2px; }
b.button:after { content: "]"; padding: 0 2px 0 3px; }
p a > code:hover { color: #561309; }
#header, #content, #footnotes, #footer { width: 100%; margin-left: auto; margin-right: auto; margin-top: 0; margin-bottom: 0; max-width: 62.5em; *zoom: 1; position: relative; padding-left: 0.9375em; padding-right: 0.9375em; }
#header:before, #header:after, #content:before, #content:after, #footnotes:before, #footnotes:after, #footer:before, #footer:after { content: " "; display: table; }
#header:after, #content:after, #footnotes:after, #footer:after { clear: both; }
#header { margin-bottom: 2.5em; }
#header > h1 { color: black; font-weight: normal; border-bottom: 1px solid #dddddd; margin-bottom: -28px; padding-bottom: 32px; }
#header span { color: #6f6f6f; }
#header #revnumber { text-transform: capitalize; }
#header br { display: none; }
#header br + span { padding-left: 3px; }
#header br + span:before { content: "\2013 \0020"; }
#header br + span.author { padding-left: 0; }
#header br + span.author:before { content: ", "; }
#toc { border-bottom: 3px double #ebebeb; padding-bottom: 1.25em; }
#toc > ul { margin-left: 0.25em; }
#toc ul.sectlevel0 > li > a { font-style: italic; }
#toc ul.sectlevel0 ul.sectlevel1 { margin-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
#toc ul { list-style-type: none; }
#toctitle { color: #7a2518; }
@media only screen and (min-width: 768px) { body.toc2 { padding-left: 15em; padding-right: 0; }
  #toc.toc2 { position: fixed; width: 15em; left: 0; top: 0; border-right: 1px solid #ebebeb; border-bottom: 0; z-index: 1000; padding: 1em; height: 100%; overflow: auto; }
  #toc.toc2 #toctitle { margin-top: 0; font-size: 1.2em; }
  #toc.toc2 > ul { font-size: .90em; }
  #toc.toc2 ul ul { margin-left: 0; padding-left: 1em; }
  #toc.toc2 ul.sectlevel0 ul.sectlevel1 { padding-left: 0; margin-top: 0.5em; margin-bottom: 0.5em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 15em; }
  body.toc2.toc-right #toc.toc2 { border-right: 0; border-left: 1px solid #ebebeb; left: auto; right: 0; } }
@media only screen and (min-width: 1280px) { body.toc2 { padding-left: 20em; padding-right: 0; }
  #toc.toc2 { width: 20em; }
  #toc.toc2 #toctitle { font-size: 1.375em; }
  #toc.toc2 > ul { font-size: 0.95em; }
  #toc.toc2 ul ul { padding-left: 1.25em; }
  body.toc2.toc-right { padding-left: 0; padding-right: 20em; } }
#content #toc { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; border-width: 0; -webkit-border-radius: 4px; border-radius: 4px; }
#content #toc > :first-child { margin-top: 0; }
#content #toc > :last-child { margin-bottom: 0; }
#content #toc a { text-decoration: none; }
#content #toctitle { font-weight: bold; font-family: "Helvetica Neue", "Helvetica", Helvetica, Arial, sans-serif; font-size: 1em; padding-left: 0.125em; }
#footer { max-width: 100%; background-color: #222222; padding: 1.25em; }
#footer-text { color: #dddddd; line-height: 1.44; }
.sect1 { padding-bottom: 1.25em; }
.sect1 + .sect1 { border-top: 3px double #ebebeb; }
#content h1 > a.anchor, h2 > a.anchor, h3 > a.anchor, #toctitle > a.anchor, .sidebarblock > .content > .title > a.anchor, h4 > a.anchor, h5 > a.anchor, h6 > a.anchor { position: absolute; width: 1em; margin-left: -1em; display: block; text-decoration: none; visibility: hidden; text-align: center; font-weight: normal; }
#content h1 > a.anchor:before, h2 > a.anchor:before, h3 > a.anchor:before, #toctitle > a.anchor:before, .sidebarblock > .content > .title > a.anchor:before, h4 > a.anchor:before, h5 > a.anchor:before, h6 > a.anchor:before { content: '\00A7'; font-size: .85em; vertical-align: text-top; display: block; margin-top: 0.05em; }
#content h1:hover > a.anchor, #content h1 > a.anchor:hover, h2:hover > a.anchor, h2 > a.anchor:hover, h3:hover > a.anchor, #toctitle:hover > a.anchor, .sidebarblock > .content > .title:hover > a.anchor, h3 > a.anchor:hover, #toctitle > a.anchor:hover, .sidebarblock > .content > .title > a.anchor:hover, h4:hover > a.anchor, h4 > a.anchor:hover, h5:hover > a.anchor, h5 > a.anchor:hover, h6:hover > a.anchor, h6 > a.anchor:hover { visibility: visible; }
#content h1 > a.link, h2 > a.link, h3 > a.link, #toctitle > a.link, .sidebarblock > .content > .title > a.link, h4 > a.link, h5 > a.link, h6 > a.link { color: #ba3925; text-decoration: none; }
#content h1 > a.link:hover, h2 > a.link:hover, h3 > a.link:hover, #toctitle > a.link:hover, .sidebarblock > .content > .title > a.link:hover, h4 > a.link:hover, h5 > a.link:hover, h6 > a.link:hover { color: #a53221; }
.imageblock, .literalblock, .listingblock, .mathblock, .verseblock, .videoblock { margin-bottom: 1.25em; }
.admonitionblock td.content > .title, .exampleblock > .title, .imageblock > .title, .listingblock > .title, .literalblock > .title, .mathblock > .title, .openblock > .title, .paragraph > .title, .quoteblock > .title, .sidebarblock > .title, .tableblock > .title, .verseblock > .title, .videoblock > .title, .dlist > .title, .olist > .title, .ulist > .title, .qlist > .title, .hdlist > .title { text-align: left; font-weight: bold; }
.tableblock > caption { text-align: left; font-weight: bold; white-space: nowrap; overflow: visible; max-width: 0; }
table.tableblock #preamble > .sectionbody > .paragraph:first-of-type p { font-size: inherit; }
.admonitionblock > table { border: 0; background: none; width: 100%; }
.admonitionblock > table td.icon { text-align: center; width: 80px; }
.admonitionblock > table td.icon img { max-width: none; }
.admonitionblock > table td.icon .title { font-weight: bold; text-transform: uppercase; }
.admonitionblock > table td.content { padding-left: 1.125em; padding-right: 1.25em; border-left: 1px solid #dddddd; color: #6f6f6f; }
.admonitionblock > table td.content > :last-child > :last-child { margin-bottom: 0; }
.exampleblock > .content { border-style: solid; border-width: 1px; border-color: #e6e6e6; margin-bottom: 1.25em; padding: 1.25em; background: white; -webkit-border-radius: 4px; border-radius: 4px; }
.exampleblock > .content > :first-child { margin-top: 0; }
.exampleblock > .content > :last-child { margin-bottom: 0; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6, .exampleblock > .content p { color: #333333; }
.exampleblock > .content h1, .exampleblock > .content h2, .exampleblock > .content h3, .exampleblock > .content #toctitle, .sidebarblock.exampleblock > .content > .title, .exampleblock > .content h4, .exampleblock > .content h5, .exampleblock > .content h6 { line-height: 1; margin-bottom: 0.625em; }
.exampleblock > .content h1.subheader, .exampleblock > .content h2.subheader, .exampleblock > .content h3.subheader, .exampleblock > .content .subheader#toctitle, .sidebarblock.exampleblock > .content > .subheader.title, .exampleblock > .content h4.subheader, .exampleblock > .content h5.subheader, .exampleblock > .content h6.subheader { line-height: 1.4; }
.exampleblock.result > .content { -webkit-box-shadow: 0 1px 8px #d9d9d9; box-shadow: 0 1px 8px #d9d9d9; }
.sidebarblock { border-style: solid; border-width: 1px; border-color: #d9d9d9; margin-bottom: 1.25em; padding: 1.25em; background: #f2f2f2; -webkit-border-radius: 4px; border-radius: 4px; }
.sidebarblock > :first-child { margin-top: 0; }
.sidebarblock > :last-child { margin-bottom: 0; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6, .sidebarblock p { color: #333333; }
.sidebarblock h1, .sidebarblock h2, .sidebarblock h3, .sidebarblock #toctitle, .sidebarblock > .content > .title, .sidebarblock h4, .sidebarblock h5, .sidebarblock h6 { line-height: 1; margin-bottom: 0.625em; }
.sidebarblock h1.subheader, .sidebarblock h2.subheader, .sidebarblock h3.subheader, .sidebarblock .subheader#toctitle, .sidebarblock > .content > .subheader.title, .sidebarblock h4.subheader, .sidebarblock h5.subheader, .sidebarblock h6.subheader { line-height: 1.4; }
.sidebarblock > .content > .title { color: #7a2518; margin-top: 0; line-height: 1.6; }
.exampleblock > .content > :last-child > :last-child, .exampleblock > .content .olist > ol > li:last-child > :last-child, .exampleblock > .content .ulist > ul > li:last-child > :last-child, .exampleblock > .content .qlist > ol > li:last-child > :last-child, .sidebarblock > .content > :last-child > :last-child, .sidebarblock > .content .olist > ol > li:last-child > :last-child, .sidebarblock > .content .ulist > ul > li:last-child > :last-child, .sidebarblock > .content .qlist > ol > li:last-child > :last-child { margin-bottom: 0; }
.literalblock pre:not([class]), .listingblock pre:not([class]) { background: none; }
.literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { border-width: 1px 0; border-style: dotted; border-color: #bfbfbf; -webkit-border-radius: 4px; border-radius: 4px; padding: 0.75em 0.75em 0.5em 0.75em; word-wrap: break-word; }
.literalblock pre.nowrap, .literalblock pre[class].nowrap, .listingblock pre.nowrap, .listingblock pre[class].nowrap { overflow-x: auto; white-space: pre; word-wrap: normal; }
.literalblock pre > code, .literalblock pre[class] > code, .listingblock pre > code, .listingblock pre[class] > code { display: block; }
@media only screen { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.8em; } }
@media only screen and (min-width: 768px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 0.9em; } }
@media only screen and (min-width: 1280px) { .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] { font-size: 1em; } }
.listingblock pre.highlight { padding: 0; }
.listingblock pre.highlight > code { padding: 0.75em 0.75em 0.5em 0.75em; }
.listingblock > .content { position: relative; }
.listingblock:hover code[class*=" language-"]:before { text-transform: uppercase; font-size: 0.9em; color: #999; position: absolute; top: 0.375em; right: 0.375em; }
.listingblock:hover code.asciidoc:before { content: "asciidoc"; }
.listingblock:hover code.clojure:before { content: "clojure"; }
.listingblock:hover code.css:before { content: "css"; }
.listingblock:hover code.groovy:before { content: "groovy"; }
.listingblock:hover code.html:before { content: "html"; }
.listingblock:hover code.java:before { content: "java"; }
.listingblock:hover code.javascript:before { content: "javascript"; }
.listingblock:hover code.python:before { content: "python"; }
.listingblock:hover code.ruby:before { content: "ruby"; }
.listingblock:hover code.sass:before { content: "sass"; }
.listingblock:hover code.scss:before { content: "scss"; }
.listingblock:hover code.xml:before { content: "xml"; }
.listingblock:hover code.yaml:before { content: "yaml"; }
.listingblock.terminal pre .command:before { content: attr(data-prompt); padding-right: 0.5em; color: #999; }
.listingblock.terminal pre .command:not([data-prompt]):before { content: '$'; }
table.pyhltable { border: 0; margin-bottom: 0; }
table.pyhltable td { vertical-align: top; padding-top: 0; padding-bottom: 0; }
table.pyhltable td.code { padding-left: .75em; padding-right: 0; }
.highlight.pygments .lineno, table.pyhltable td:not(.code) { color: #999; padding-left: 0; padding-right: .5em; border-right: 1px solid #dddddd; }
.highlight.pygments .lineno { display: inline-block; margin-right: .25em; }
table.pyhltable .linenodiv { background-color: transparent !important; padding-right: 0 !important; }
.quoteblock { margin: 0 0 1.25em; padding: 0.5625em 1.25em 0 1.1875em; border-left: 1px solid #dddddd; }
.quoteblock blockquote { margin: 0 0 1.25em 0; padding: 0 0 0.5625em 0; border: 0; }
.quoteblock blockquote > .paragraph:last-child p { margin-bottom: 0; }
.quoteblock .attribution { margin-top: -.25em; padding-bottom: 0.5625em; font-size: inherit; color: #555555; }
.quoteblock .attribution br { display: none; }
.quoteblock .attribution cite { display: block; margin-bottom: 0.625em; }
table thead th, table tfoot th { font-weight: bold; }
table.tableblock.grid-all { border-collapse: separate; border-spacing: 1px; -webkit-border-radius: 4px; border-radius: 4px; border-top: 1px solid #dddddd; border-bottom: 1px solid #dddddd; }
table.tableblock.frame-topbot, table.tableblock.frame-none { border-left: 0; border-right: 0; }
table.tableblock.frame-sides, table.tableblock.frame-none { border-top: 0; border-bottom: 0; }
table.tableblock td .paragraph:last-child p > p:last-child, table.tableblock th > p:last-child, table.tableblock td > p:last-child { margin-bottom: 0; }
th.tableblock.halign-left, td.tableblock.halign-left { text-align: left; }
th.tableblock.halign-right, td.tableblock.halign-right { text-align: right; }
th.tableblock.halign-center, td.tableblock.halign-center { text-align: center; }
th.tableblock.valign-top, td.tableblock.valign-top { vertical-align: top; }
th.tableblock.valign-bottom, td.tableblock.valign-bottom { vertical-align: bottom; }
th.tableblock.valign-middle, td.tableblock.valign-middle { vertical-align: middle; }
tbody tr th { display: table-cell; line-height: 1.6; background: whitesmoke; }
tbody tr th, tbody tr th p, tfoot tr th, tfoot tr th p { color: #222222; font-weight: bold; }
td > div.verse { white-space: pre; }
ol { margin-left: 1.75em; }
ul li ol { margin-left: 1.5em; }
dl dd { margin-left: 1.125em; }
dl dd:last-child, dl dd:last-child > :last-child { margin-bottom: 0; }
ol > li p, ul > li p, ul dd, ol dd, .olist .olist, .ulist .ulist, .ulist .olist, .olist .ulist { margin-bottom: 0.625em; }
ul.unstyled, ol.unnumbered, ul.checklist, ul.none { list-style-type: none; }
ul.unstyled, ol.unnumbered, ul.checklist { margin-left: 0.625em; }
ul.checklist li > p:first-child > i[class^="icon-check"]:first-child, ul.checklist li > p:first-child > input[type="checkbox"]:first-child { margin-right: 0.25em; }
ul.checklist li > p:first-child > input[type="checkbox"]:first-child { position: relative; top: 1px; }
ul.inline { margin: 0 auto 0.625em auto; margin-left: -1.375em; margin-right: 0; padding: 0; list-style: none; overflow: hidden; }
ul.inline > li { list-style: none; float: left; margin-left: 1.375em; display: block; }
ul.inline > li > * { display: block; }
.unstyled dl dt { font-weight: normal; font-style: normal; }
ol.arabic { list-style-type: decimal; }
ol.decimal { list-style-type: decimal-leading-zero; }
ol.loweralpha { list-style-type: lower-alpha; }
ol.upperalpha { list-style-type: upper-alpha; }
ol.lowerroman { list-style-type: lower-roman; }
ol.upperroman { list-style-type: upper-roman; }
ol.lowergreek { list-style-type: lower-greek; }
.hdlist > table, .colist > table { border: 0; background: none; }
.hdlist > table > tbody > tr, .colist > table > tbody > tr { background: none; }
td.hdlist1 { padding-right: .8em; font-weight: bold; }
td.hdlist1, td.hdlist2 { vertical-align: top; }
.literalblock + .colist, .listingblock + .colist { margin-top: -0.5em; }
.colist > table tr > td:first-of-type { padding: 0 .8em; line-height: 1; }
.colist > table tr > td:last-of-type { padding: 0.25em 0; }
.qanda > ol > li > p > em:only-child { color: #00467f; }
.thumb, .th { line-height: 0; display: inline-block; border: solid 4px white; -webkit-box-shadow: 0 0 0 1px #dddddd; box-shadow: 0 0 0 1px #dddddd; }
.imageblock.left, .imageblock[style*="float: left"] { margin: 0.25em 0.625em 1.25em 0; }
.imageblock.right, .imageblock[style*="float: right"] { margin: 0.25em 0 1.25em 0.625em; }
.imageblock > .title { margin-bottom: 0; }
.imageblock.thumb, .imageblock.th { border-width: 6px; }
.imageblock.thumb > .title, .imageblock.th > .title { padding: 0 0.125em; }
.image.left, .image.right { margin-top: 0.25em; margin-bottom: 0.25em; display: inline-block; line-height: 0; }
.image.left { margin-right: 0.625em; }
.image.right { margin-left: 0.625em; }
a.image { text-decoration: none; }
span.footnote, span.footnoteref { vertical-align: super; font-size: 0.875em; }
span.footnote a, span.footnoteref a { text-decoration: none; }
#footnotes { padding-top: 0.75em; padding-bottom: 0.75em; margin-bottom: 0.625em; }
#footnotes hr { width: 20%; min-width: 6.25em; margin: -.25em 0 .75em 0; border-width: 1px 0 0 0; }
#footnotes .footnote { padding: 0 0.375em; line-height: 1.3; font-size: 0.875em; margin-left: 1.2em; text-indent: -1.2em; margin-bottom: .2em; }
#footnotes .footnote a:first-of-type { font-weight: bold; text-decoration: none; }
#footnotes .footnote:last-of-type { margin-bottom: 0; }
#content #footnotes { margin-top: -0.625em; margin-bottom: 0; padding: 0.75em 0; }
.gist .file-data > table { border: none; background: #fff; width: 100%; margin-bottom: 0; }
.gist .file-data > table td.line-data { width: 99%; }
div.unbreakable { page-break-inside: avoid; }
.big { font-size: larger; }
.small { font-size: smaller; }
.underline { text-decoration: underline; }
.overline { text-decoration: overline; }
.line-through { text-decoration: line-through; }
.aqua { color: #00bfbf; }
.aqua-background { background-color: #00fafa; }
.black { color: black; }
.black-background { background-color: black; }
.blue { color: #0000bf; }
.blue-background { background-color: #0000fa; }
.fuchsia { color: #bf00bf; }
.fuchsia-background { background-color: #fa00fa; }
.gray { color: #606060; }
.gray-background { background-color: #7d7d7d; }
.green { color: #006000; }
.green-background { background-color: #007d00; }
.lime { color: #00bf00; }
.lime-background { background-color: #00fa00; }
.maroon { color: #600000; }
.maroon-background { background-color: #7d0000; }
.navy { color: #000060; }
.navy-background { background-color: #00007d; }
.olive { color: #606000; }
.olive-background { background-color: #7d7d00; }
.purple { color: #600060; }
.purple-background { background-color: #7d007d; }
.red { color: #bf0000; }
.red-background { background-color: #fa0000; }
.silver { color: #909090; }
.silver-background { background-color: #bcbcbc; }
.teal { color: #006060; }
.teal-background { background-color: #007d7d; }
.white { color: #bfbfbf; }
.white-background { background-color: #fafafa; }
.yellow { color: #bfbf00; }
.yellow-background { background-color: #fafa00; }
span.icon > [class^="icon-"], span.icon > [class*=" icon-"] { cursor: default; }
.admonitionblock td.icon [class^="icon-"]:before { font-size: 2.5em; text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5); cursor: default; }
.admonitionblock td.icon .icon-note:before { content: "\f05a"; color: #005498; color: #003f72; }
.admonitionblock td.icon .icon-tip:before { content: "\f0eb"; text-shadow: 1px 1px 2px rgba(155, 155, 0, 0.8); color: #111; }
.admonitionblock td.icon .icon-warning:before { content: "\f071"; color: #bf6900; }
.admonitionblock td.icon .icon-caution:before { content: "\f06d"; color: #bf3400; }
.admonitionblock td.icon .icon-important:before { content: "\f06a"; color: #bf0000; }
.conum { display: inline-block; color: white !important; background-color: #222222; -webkit-border-radius: 100px; border-radius: 100px; text-align: center; width: 20px; height: 20px; font-size: 12px; font-weight: bold; line-height: 20px; font-family: Arial, sans-serif; font-style: normal; position: relative; top: -2px; letter-spacing: -1px; }
.conum * { color: white !important; }
.conum + b { display: none; }
.conum:after { content: attr(data-value); }
.conum:not([data-value]):empty { display: none; }
#toc.toc2 { background: white; }
.literalblock > .content > pre, .listingblock > .content > pre { -webkit-border-radius: 0; border-radius: 0; }
</style>
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css">
<link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/r298/prettify.min.js"></script>
<script>document.addEventListener('DOMContentLoaded', prettyPrint)</script>
</head>
<body class="article">
<div id="header">
<h1>GR8 CRM - Content Management Plugin</h1>
<span id="author" class="author">Göran Ehrsson</span><br>
<span id="email" class="email"><a href="mailto:goran@technipelago.se">goran@technipelago.se</a></span><br>
<span id="revnumber">version 2.0.0</span>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#crm-introduction">1. Introduction</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#crm-customer-relationship-management">1.1. Customer Relationship Management</a></li>
</ul>
</li>
<li><a href="#crm-content-management-plugin">2. Content Management Plugin</a></li>
<li><a href="#crm-storage">3. Storage</a></li>
<li><a href="#crm-attachments">4. Attachments</a></li>
<li><a href="#crm-security">5. Security</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#crm-access-control">5.1. Access Control</a></li>
<li><a href="#crm-encryption">5.2. Encryption</a></li>
</ul>
</li>
<li><a href="#crm-crmcontentservice">6. CrmContentService</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#crm-createresource">6.1. createResource</a></li>
<li><a href="#crm-withinputstream">6.2. withInputStream</a></li>
<li><a href="#crm-writeto">6.3. writeTo</a></li>
<li><a href="#crm-getmetadata">6.4. getMetadata</a></li>
<li><a href="#crm-updateresource">6.5. updateResource</a></li>
</ul>
</li>
<li><a href="#crm-crmfreemarkerservice">7. CrmFreeMarkerService</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#crm-process">7.1. process</a></li>
</ul>
</li>
<li><a href="#crm-events">8. Events</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#crm-parsetemplate">8.1. parseTemplate</a></li>
</ul>
</li>
<li><a href="#crm-code-samples">9. Code Samples</a></li>
<li>
<ul class="sectlevel2">
<li><a href="#crm-create-a-folder">9.1. Create a folder</a></li>
<li><a href="#crm-create-a-file">9.2. Create a file</a></li>
</ul>
</li>
<li><a href="#crm-configuration">10. Configuration</a></li>
<li><a href="#crm-license">11. License</a></li>
<li><a href="#crm-source-code">12. Source Code</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="crm-introduction">1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GR8 CRM is a set of <a href="http://www.grails.org/">Grails Web Application Framework</a>
plugins that makes it easy to develop web applications with CRM functionality.</p>
</div>
<div class="paragraph">
<p>You can find more information about GR8 CRM on the main documentation site <a href="http://gr8crm.github.io">http://gr8crm.github.io</a>.</p>
</div>
<div class="sect2">
<h3 id="crm-customer-relationship-management">1.1. Customer Relationship Management</h3>
<div class="paragraph">
<p>Customer relationship management (CRM) is a system for managing a company’s interactions with current and future customers.
It involves using technology to organize, automate and synchronize sales, marketing, customer service, and technical support.
<a href="http://en.wikipedia.org/wiki/Customer_relationship_management">Wikipedia</a></p>
</div>
<div class="paragraph">
<p>The GR8 CRM "Ecosystem" currently contains over 40 Grails plugins. For a complete list of plugins see <a href="http://gr8crm.github.io">http://gr8crm.github.io</a>.</p>
</div>
<div class="paragraph">
<p>Each GR8 CRM plugin defines a <a href="http://martinfowler.com/bliki/BoundedContext.html">Bounded Context</a>
that focus on one specific domain, for example <strong>contact</strong>, <strong>project</strong> or <strong>document</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-content-management-plugin">2. Content Management Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This plugin provide storage and services for managing content in GR8 CRM applications.
Content can be any type of media like plain text, Microsoft Word, PDF, and images.
Content can be stored in folders or attached to domain instances.
Content can be shared with users of the application or shared publicly to the world.</p>
</div>
<div class="paragraph">
<p>Note that this plugin does not contain any user interface components. This plugin contains domain classes and services only.
The plugin <a href="http://gr8crm.github.io/plugins/crm-content-ui/">crm-content-ui</a> provides a Twitter Bootstrap based user interface
for managing files, folders and attachments. <code>crm-content-ui</code> depends on <code>crm-content</code> so you only need to include <code>crm-content-ui</code>
in your BuildConfig.groovy if you want end-user content management features.</p>
</div>
<div class="paragraph">
<p>The Content Management plugin is very generic and flexible. It can be used to provide content in any form.
Here are some real-wold examples on what type of content that can be stored and managed by this plugin.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>System HTML email templates that can be edited by an administrator</p>
</li>
<li>
<p>Attach documents to customer records, like contracts, tenders or spreadsheets</p>
</li>
<li>
<p>User guides in PDF or other eReader formats</p>
</li>
<li>
<p>HTML page fragments to be included in Groovy Server Pages</p>
</li>
<li>
<p>Complete HTML pages to be rendered as part of a web site</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-storage">3. Storage</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>crm-content</code> plugin has configurable <strong>storage providers</strong>. The default storage provider store
content in the web server filesystem. Files on disk can optionally be encrypted for increased security.
Custom storage providers can be developed to integrate with content services like Amazon S3, Google Drive or Dropbox.
One application can have multiple storage providers and select the best storage provides based on some business logic.
Maybe HTML files should be stored in a S3 bucket and customer contracts encrypted on  a local disk.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-attachments">4. Attachments</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Content is usually stored in folders but content can also be attached to domain instances.
In fact when content is stored in a folder, it is actually "attached" to a <code>CrmResourceFolder</code> domain instance.
So there is no technical difference between files stored in folders and files attached to domain instances.</p>
</div>
<div class="paragraph">
<p>A <code>CrmResourceRef</code> instance is used to attach content to a domain instance. The <code>ref</code> property references
the domain instance using a <strong>Resource Identifier</strong> and the <code>res</code> property contains the provider specific URI to the content.
This is nothing that you need to care about, the framework takes care about setting these properties when you create and attach content.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-security">5. Security</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Content can contain sensitive information, therefore security is a very important in GR8 CRM applications.
All access to content is checked to make sure the user accessing content has the right privileges.
Files on disk can optionally be encrypted for increased security.</p>
</div>
<div class="sect2">
<h3 id="crm-access-control">5.1. Access Control</h3>
<div class="paragraph">
<p>An instance of the domain class <code>CrmResourceRef</code> is always involved when working with content. It represents a "handle"
to the content. It has properties like <code>filename</code>, <code>title</code> and <code>description</code>. Another important property is <code>status</code> that
specifies the status and access rights for the content. The class <code>CrmResourceRef</code> has one static <code>int</code> constant for each
possible status a content instance can have. The constants are listed below.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<caption class="title">Table 1. Content Status</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Constant</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CrmResourceRef.STATUS_DRAFT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content is in draft state and only accessible by authenticated users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CrmResourceRef.STATUS_ARCHIVED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content is archived and only accessible by authenticated users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CrmResourceRef.STATUS_PUBLISHED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content is active/current but only accessible by authenticated users</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CrmResourceRef.STATUS_SHARED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content is accessible by anyone, no authentication needed = <strong>public access if URL is known!</strong></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="crm-encryption">5.2. Encryption</h3>
<div class="paragraph">
<p>Content can be encrypted before it&#8217;s stored in the server filesystem.</p>
</div>
<div class="paragraph">
<p>The class <code>CrmFileResource</code> has static <code>int</code> constants for all supported encryption algorithms.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<caption class="title">Table 2. Content Encryption</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Constant</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CrmFileResource.NO_ENCRYPTION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content is not encrypted (default)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CrmFileResource.AES_ENCRYPTION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content is encrypted with AES encryption</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>You configure the application wide encryption key in Config.groovy. The encryption key must be 16 bytes long.</p>
</div>
<div class="paragraph">
<p><code>crm.content.encryption.password = "1234567890123456"</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="icon-note" title="Note"></i>
</td>
<td class="content">
The current implementation of <code>CrmFileResource</code> encrypts <strong>all</strong> content if <code>crm.content.encryption.password</code> is set.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-crmcontentservice">6. CrmContentService</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is the main service that you use to create, find, edit and delete files and folders with.</p>
</div>
<div class="sect2">
<h3 id="crm-createresource">6.1. createResource</h3>
<div class="paragraph">
<p><code>CrmResourceRef createResource(InputStream inputStream, String filename, Long length, String contentType, Object reference, Map params = [:])</code></p>
</div>
<div class="paragraph">
<p>Create a new file from an InputStream.</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">inputStream</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The input stream to read content from</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">filename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of content, this is later used when accessing this content</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">length</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Content length in bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contentType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIME content type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">a domain instance or a reference identifier to attach the content to</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">params</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional parameters like <code>status</code>, <code>title</code> and <code>description</code> for the content</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>If the content creation succeeds an instance of <code>CrmResourceRef</code> is returned. This is an active "handle" to the content.</p>
</div>
<div class="paragraph">
<p>The <code>resource</code> property on CrmResourceRef return a <code>URI</code> instance. This URI is used by other service methods, for example when reading and writing content.</p>
</div>
<div class="paragraph">
<p>The following code copies (moves) a PDF file from the server to a <strong>/presentations</strong> folder in GR8 CRM.</p>
</div>
<div class="listingblock">
<div class="title">CreateContent.groovy</div>
<div class="content">
<pre class="prettyprint"><code class="groovy language-groovy">def folder = crmContentService.createFolder(null, "presentations")
def serverFile = new File("presentation.pdf")
def pdf = serverFile.withInputStream{inputStream-&gt;
    crmContentService.createResource(inputStream, serverFile.name, serverFile.length(), "application/pdf", folder)
}
serverFile.delete() <i class="conum" data-value="1"></i><b>(1)</b>

assert pdf.name == "presentation.pdf"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The server file is copied into, and managed by GR8 CRM so it&#8217;s not needed anymore.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="crm-withinputstream">6.2. withInputStream</h3>
<div class="paragraph">
<p><code>def withInputStream(URI uri, Closure work)</code></p>
</div>
<div class="paragraph">
<p>For content referenced by a <code>URI</code> create a new InputStream and pass it into a closure. This method ensures the stream is closed after the closure returns.</p>
</div>
<div class="listingblock">
<div class="title">CopyContentToServerFile.groovy</div>
<div class="content">
<pre class="prettyprint"><code class="groovy language-groovy">def content = crmContentService.getContentByPath("/presentations/2014/gr8conf/eu/goeh-feature-plugins.pdf")
crmContentService.withInputStream(content.resource) { inputStream -&gt;
    new File("/tmp/feature-plugins.pdf").withOutputStream{ outputStream -&gt;
        outputStream &lt;&lt; inputStream
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="crm-writeto">6.3. writeTo</h3>
<div class="paragraph">
<p><code>long writeTo(URI uri, OutputStream out)</code></p>
</div>
<div class="paragraph">
<p>Write content to an OutputStream.</p>
</div>
<div class="listingblock">
<div class="title">MyDocController.groovy</div>
<div class="content">
<pre class="prettyprint"><code class="groovy language-groovy">def show(Long id) {
    def content = crmContentService.getResourceRef(id) <i class="conum" data-value="1"></i><b>(1)</b>
    def metadata = content.metadata
    response.setContentType(metadata.contentType)
    response.setContentLength(metadata.bytes.intValue())
    crmContentService.writeTo(content.resource, response.outputStream) <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Lookup content by ID</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Render content to the response stream. This line can be shortened to: <code>content.writeTo(response.outputStream)</code></td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="crm-getmetadata">6.4. getMetadata</h3>
<div class="paragraph">
<p><code>Map&lt;String, Object&gt; getMetadata(URI resource)</code></p>
</div>
<div class="paragraph">
<p>Get metadata for the content specified by <code>resource</code>. The metadata Map contains the following keys:</p>
</div>
<table class="tableblock frame-all grid-all" style="width: 100%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Key</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">the provider specific URI for the content</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">contentType</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIME content type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bytes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">length in bytes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">size</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">formatted length</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">icon</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">name of icon that best describes the content</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">created</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date instance when content was created</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">modified</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date instance when content was last updated</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hash</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MD5 hash of the content</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">encrypted</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type of encrypted storage (0 = no encryption)</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="crm-updateresource">6.5. updateResource</h3>
<div class="paragraph">
<p><code>long updateResource(CrmResourceRef resource, InputStream inputStream, String contentType = null)</code></p>
</div>
<div class="paragraph">
<p>Update/overwrite existing content.</p>
</div>
<div class="listingblock">
<div class="title">UpdateContent.groovy</div>
<div class="content">
<pre class="prettyprint"><code class="groovy language-groovy">def folder = crmContentService.createFolder(null, "test")
def bytes = "This is a test".getBytes()
def inputStream = new ByteArrayInputStream(bytes)
def ref = crmContentService.createResource(inputStream, "test1.txt", bytes.length, "text/plain", folder) <i class="conum" data-value="1"></i><b>(1)</b>
bytes = "This is an updated test".getBytes()
inputStream = new ByteArrayInputStream(bytes)
crmContentService.updateResource(ref, inputStream) <i class="conum" data-value="2"></i><b>(2)</b>
def result = new ByteArrayOutputStream()
ref.writeTo(result)
def s = new String(result.toByteArray())
assert s == "This is an updated test"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create a file with content "This is a test"</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Update the content to "This is an updated test"</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-crmfreemarkerservice">7. CrmFreeMarkerService</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <strong>FreeMarker</strong> service is used when you want to store <a href="http://freemarker.org" target="_blank">FreeMarker</a> templates with the <code>crm-content</code> plugin.
You can use FreeMarker templates when you send email or render HTML pages.
If used together with the <code>crm-content-ui</code> plugin you can let administrators edit templates with an HTML editor.</p>
</div>
<div class="sect2">
<h3 id="crm-process">7.1. process</h3>
<div class="paragraph">
<p><code>void process(String templatePath, Map binding, Writer out)</code></p>
</div>
<div class="paragraph">
<p>Let FreeMarker parse the template located at <code>templatePath</code> in the current tenant.
Values in <code>binding</code> can be referenced from the template. The output is written to <code>out</code>.</p>
</div>
<div class="paragraph">
<p><code>void process(Long tenant, String templatePath, Map binding, Writer out)</code></p>
</div>
<div class="paragraph">
<p>Same as above but a tenant can be specified from which templates will be retrieved.</p>
</div>
<div class="paragraph">
<p><code>void process(CrmResourceRef ref, Map binding, Writer out)</code></p>
</div>
<div class="paragraph">
<p>Same as above but an instance of <code>CrmResourceRef</code> will be used as template.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-events">8. Events</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also send an asynchronous event that results in a template being parsed.</p>
</div>
<div class="sect2">
<h3 id="crm-parsetemplate">8.1. parseTemplate</h3>
<div class="listingblock">
<div class="title">EventBasedTemplateParsingTests.groovy</div>
<div class="content">
<pre class="prettyprint"><code class="groovy language-groovy">def reply = event(namespace: 'crm', topic: 'parseTemplate', data: [template: '/templates/hello.txt', greet: 'Groovy'])
assert reply.value == 'Hello Groovy World'</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-code-samples">9. Code Samples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="crm-create-a-folder">9.1. Create a folder</h3>
<div class="listingblock">
<div class="title">CreateFolders.groovy</div>
<div class="content">
<pre class="prettyprint"><code class="groovy language-groovy">def rootFolder = crmContentService.createFolder(null, "templates")
def subFolder = crmContentService.createFolder(rootFolder, "powerpoint")</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="crm-create-a-file">9.2. Create a file</h3>
<div class="listingblock groovy">
<div class="title">CreateFile.groovy</div>
<div class="content">
<pre class="prettyprint"><code>def bytes = "Hello World".getBytes()
def inputStream = new ByteArrayInputStream(bytes) <i class="conum" data-value="1"></i><b>(1)</b>
def folder = crmContentService.createFolder(null, "files")
def doc = crmContentService.createResource(inputStream, "hello.txt", bytes.length, "text/plain", folder)
assert doc.title == "test1"
assert doc.name == "test1.txt"
assert doc.text == "Hello World"</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The stream is closed by createResource(&#8230;)</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="icon-tip" title="Tip"></i>
</td>
<td class="content">
You can look at the source code for the <a href="https://github.com/technipelago/grails-crm-content/tree/master/test/integration/grails/plugins/crm/content" target="_blank">integration tests</a> to find more code examples.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-configuration">10. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>crm.content.encryption.algorithm</code></p>
</div>
<div class="paragraph">
<p>This property defines what encryption algorithm to use when storing files.
File are by default stored in the filesystem on the application server.
One of the following algorithms can be used:</p>
</div>
<div class="paragraph">
<p><code>grails.plugins.crm.content.CrmFileResource.NO_ENCRYPTION</code> (default)</p>
</div>
<div class="paragraph">
<p>Files are not encrypted, they are stored in original form.</p>
</div>
<div class="paragraph">
<p><code>grails.plugins.crm.content.CrmFileResource.AES_ENCRYPTION</code></p>
</div>
<div class="paragraph">
<p>Files are encrypted with AES encryption</p>
</div>
<div class="paragraph">
<p><code>crm.content.encryption.password = "1234567890123456"</code></p>
</div>
<div class="paragraph">
<p>Encryption key. Must be 16 bytes!</p>
</div>
<div class="paragraph">
<p><code>crm.content.cache.expires = 60 * 10</code></p>
</div>
<div class="paragraph">
<p>Browser cache expiration (in seconds) for public content.</p>
</div>
<div class="paragraph">
<p><code>crm.content.include.tenant = 1L</code></p>
</div>
<div class="paragraph">
<p>Default tenant for content rendered with the render tag.</p>
</div>
<div class="paragraph">
<p><code>crm.content.include.path = <em>/templates</em></code></p>
</div>
<div class="paragraph">
<p>Default path for content rendered with the render tag.</p>
</div>
<div class="paragraph">
<p><code>crm.content.include.parser = <em>freemarker</em></code></p>
</div>
<div class="paragraph">
<p>Default parser for content rendered with the render tag.</p>
</div>
<div class="paragraph">
<p><code>crm.content.freemarker.template.updateDelay = 60</code></p>
</div>
<div class="paragraph">
<p>The FreeMarker service checks if templates has been updated with this interval (in seconds).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-license">11. License</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This plugin is licensed with <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License version 2.0</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="crm-source-code">12. Source Code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The source code for this plugin is available at <a href="https://github.com/technipelago/grails-crm-content">https://github.com/technipelago/grails-crm-content</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Version 2.0.0<br>
Last updated 2014-07-26 12:52:26 CEST
</div>
</div>
</body>
</html>